<!doctype html>
<html>
    <head>
        <meta charset=utf-8>
        <title>Mastodon Archive Viewer</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
        <link rel="stylesheet" href="mastodon.css">
    </head>
    <body>
        <div class="progress invisible" id="progress">
            <div class="indeterminate"></div>
        </div>
        <div class="header">
            <div class="row container" id="error-box" style="display: none;">
                <div class="card-panel">
                    <button onclick='document.getElementById("error-box").style.display = "none"'>×</button>
                    <span>Error: <span id="error-text"></span></span>
                </div>
            </div>    
            <p id="dropArea" class="">ここにoutbox.jsonとlikes.jsonをドロップしてください<br>または</p>       
        </div>
        <div id="load" class="">
            <h1>Welcome to Mastodon Archive Viewer</h1>
            <div id="upFileWrap">
                <div id="inputFile">
                    <div id="inputFileWrap">
                        <input type="file" name="uploadFile" id="uploadFile" multiple="multiple" accept=".json">
                        <div id="btnInputFile"><span>ファイルを選択する</span></div>
                    </div>
                </div>
            </div>
        </div>        
        <div id="main" class="invisible">
            <div class="result">
            <button class="opclbutton" href="#readmore1" onclick="openclose(this);">Summary</button>                       
            <div id="readmore1" class="">

                <div class="summary">
                    <div class="figure">
                        <p><canvas id="circle" style="position:relative; height:70;"></canvas></p>
                    </div>
                    <div class="post">
                        <p>You have posted <b id="sumpostcounter"></b> times.</p>
                        <table>
                            <tr>
                                <td class="right"><b id="publiccounter"></b></td>
                                <td>  times in public</td>
                            </tr>
                            <tr>
                                <td class="right"><b id="unlistedcounter"></b></td>
                                <td>  times in unlisted</td>
                            </tr>
                            <tr>
                                <td class="right"><b id="privatecounter"></b></td>
                                <td>  times in private</td>
                            </tr>
                            <tr>
                                <td class="right"><b id="directcounter"></b></td>
                                <td>  times in direct</td>
                            </tr>
                        </table>
                    </div>                
                    <div class="others">
                        <p>You have boosted <b id="boostcounter"></b> toots.</p>
                        <p>You have replied <b id="replycounter"></b> times.</p>
                        <p>You have favourited <b id="favcounter"></b> times.</p>
                    </div>
                </div>
                <p class="readlessbutton">
                    <a href="#readmore1" onclick="openclose(this);">Close</a>
                </p>
            </div>
            </div>
            
            <div class="result">
            <button class="opclbutton" href="#readmore2" onclick="openclose(this);">Figure</button>  
            <div id="readmore2" class="invisible">            
                <div class ="figure">
                    <p>
                        You toot <b id="daten"></b>/<b id="wholedays"></b> days(<b id="uprate"></b>%), since <b id="init"></b> and <b id="aver"></b> times per day.
                    </p>
                    <p><canvas id = "dateplot" style="position:relative; width:80%"></canvas></p>
                    <p class="downloadbutton">
                        <a href="#dateplot" onclick="downLoad(this);">Download </a>
                        <a id="downloadlink"></a>
                    </p>
                    
                    <p>You tooted most...</p>
                    <b id="daterank"></b>
                    <p><canvas id = "timeplot" style="position:relative; height:100; width:90%"></canvas></p>
                    <p class="downloadbutton">
                        <a href="#timeplot" onclick="downLoad(this);">Download </a>
                    </p>
                    <p>You toot most...</p>
                    <b id="timerank"></b>
                    <p><canvas id = "datetimescatter" style="position:relative; width:80%"></canvas></p>
                    <p class="downloadbutton">
                        <a href="#datetimescatter" onclick="downLoad(this);">Download </a>
                    </p>
                </div>
                <p class="readlessbutton">
                    <a href="#readmore2" onclick="openclose(this);">Close</a>
                </p>
            </div>  
            </div>
            
            <div class="result">          
            <button class="opclbutton" href="#readmore3" onclick="openclose(this);">Ranking</button>  
            <div id="readmore3" class="invisible">                   
                <div class="ranking">
                    <div class="mention">
                        <p>You have mentioned to...</p>
                        <b id="replyrank"></b>
                    </div>
                    
                    <div class="boost">
                        <p>You have boosted from...</p>
                        <b id="boostrank"></b>
                    </div>
                    
                    <div class="fav">
                        <p>You have favourited toots of...</p>
                        <b id="favrank"></b>
                    </div>
                </div>
                <p class="readlessbutton">
                    <a href="#readmore3" onclick="openclose(this);">Close</a>
                </p>
            </div>
            </div>
            
            <div class="result">   
            <button class="opclbutton" href="#readmore4" onclick="openclose(this);">Search</button>  
            <div id="readmore4" class="invisible">                     
                <div class=search>
                    <div class=searchbox>
                        <div><input placeholder="Word" class=text type=text id=word></div>
                        <div><input placeholder="Boost From" class=text type=text id=boost></div>
                        <div><input placeholder="Reply To" class=text type=text id=reply></div>
                        <div><input placeholder="YYYY-MM-DD hh:mm:ss" class=text type=text id=date></div>
                    </div>
                    <input class=submit type=submit value=Search onclick="loadSearch();"><br>
                    <b id=searchcontent></b><br>
                    <b id=searchresult></b>
                </div>
                <p class="readlessbutton">
                    <a href="#readmore4" onclick="openclose(this);">Close</a>
                </p>
            </div>
            </div>
        </div>
        <div class="footer">
            <div class="foot">
                <h2>全てJavaScriptで処理されているため、サーバーにデータは保存されません。</h2>
                <h2>ページを更新するとファイル選択画面に戻ります<br>ファイルを間違えた場合はページを更新してください。</h2>
                <a target="_blank" href="https://github.com/onekodate/mastodon">ソースコード</a><br>
                開発者:<a target="_blank" href="https://mstdn.beer/web/accounts/80060">@onekodate@mstdn.beer</a><br>
                <h2>JavascriptでMastodonのアーカイブを可視化するアイデアとソースコードの多くはnzwsさんによるものです。<a target="_blank" href="https://github.com/yuzulabo/Mastodon-Archive-Viewer">nzwsさんによるMastodon-Archive-Viewer</a></h2>
            </div>
        </div>
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.min.js"></script>
        <script src="mastodon.js"></script>

    </body>
</html>
